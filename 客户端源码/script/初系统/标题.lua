--======================================================================--
--	☆ 作者：飞蛾扑火 QQ：1415559882
--======================================================================--
local 场景类_标题 = class()
local tp

function 场景类_标题:初始化(根)
	local 资源 = 根.资源
	local 按钮 = 根._按钮
	local 滑块 = 根._滑块
	local 自适应 = 根._自适应
	self.标题背景 = 资源:载入('界面修复.wdf',"网易WDF动画",0xabcde003)
    self.场景覆盖 = 资源:载入('界面修复.wdf',"网易WDF动画",0xEB3FD8C3)
    self.场景计次 = self.场景覆盖.宽度
    self.场景覆盖:置区域(self.场景计次,0,全局游戏宽度,全局游戏高度)
   -- self.标题背景公告 = 根._按钮(资源:载入('登陆资源.wdf',"网易WDF动画",0xD8632D23),0,0,3,true,true)
    self.标题背景公告 =资源:载入(wdf配置.."/pic/公告背景.png","图片")
    self.特效覆盖 = 资源:载入('界面修复.wdf',"网易WDF动画",0xEC1A0419)
    self.特效计次 = self.特效覆盖.宽度
    self.特效覆盖:置区域(self.特效计次,0,全局游戏宽度,全局游戏高度)
	self.温馨提示 = 资源:载入('other1.wdf',"网易WDF动画",0x00000069)

	local dh = {0xDC739617,0x22E6E35C,0x16CC1B46,0xD8632D20}
    self.动画 = {}
	for n=1,4 do
	    self.动画[n] = 资源:载入('登陆资源.wdf',"网易WDF动画",dh[n])
	end

	self.资源组 = {
		[5] = 根._按钮(资源:载入('other1.wdf',"网易WDF动画",0x00000031),0,0,3,true,true),--按钮.创建(自适应.创建(20,4,18,19,4,3),0,0,4,true,true),
		[6] = 根._按钮(资源:载入('other1.wdf',"网易WDF动画",0x00000032),0,0,3,true,true),--按钮.创建(自适应.创建(21,4,18,19,4,3),0,0,4,true,true),
		[10] = 滑块.创建(自适应.创建(11,4,7,40,2,3,nil),4,14,213,2),
	}


	self.退出游戏 = 根._按钮(资源:载入('登陆资源.wdf',"网易WDF动画",0xD8632D22),0,0,3,true,true)
	self.进入游戏 = 根._按钮(资源:载入('登陆资源.wdf',"网易WDF动画",0xD8632D21),0,0,3,true,true) --下一步
	self.游戏公告 = 根._按钮(资源:载入('登陆资源.wdf',"网易WDF动画",0xD8632D24),0,0,3,true,true)
	self.免注册体验 = 根._按钮(资源:载入('other1.wdf',"网易WDF动画",0x00000003),0,0,3,true,true)
	self.注册账号 = 根._按钮(资源:载入('登陆资源.wdf',"网易WDF动画",0xD8632D2C),0,0,3,true,true)
	self.制作团队 = 根._按钮(资源:载入('other1.wdf',"网易WDF动画",0x00000042),0,0,3,true,true)
	--self.梦幻LOGO = 资源:载入('界面修复.wdf',"网易WDF动画",0x00010006)
	self.梦幻LOGO = 资源:载入(wdf配置.."/pic/logo.png", "图片")
	self.游戏建议 = 资源:载入('界面修复.wdf',"网易WDF动画",0x00010007)
	self.服务条款 = 资源:载入('界面修复.wdf',"网易WDF动画",0x00010008)
	self.欢迎 = 资源:载入('other1.wdf',"网易WDF动画",0x00000086)
    self.滑道 = 根._按钮(资源:载入('other1.wdf',"网易WDF动画",0x00000019),0,0,3,true,true)

	tp = 根
    self.当前标签 = "公告榜"
    self.标签文件 = {
      公告榜 = [[data/标题配置.txt]],
      游戏建议 = [[data/游戏建议.txt]],
      服务条款 = [[data/服务条款.txt]],
    }
    self.丰富文本说明 = 根._丰富文本(515,280)
    self:切换标签(self.当前标签)
	self.资源组[10]:置起始点(0)









end

function 场景类_标题:切换标签(标签)
  self.当前标签 = 标签
  local 文件 = self.标签文件[标签] or self.标签文件["公告榜"]
  self.丰富文本说明:清空()
  self.丰富文本说明:添加文本(读入文件(文件))
  self.丰富文本说明.滚动值 = self.丰富文本说明.行数量
  self.丰富文本说明:滚动(self.丰富文本说明.滚动值)
  self.丰富文本说明:滚动(-20)
  self.介绍加入 = 0
end

function 场景类_标题:显示(dt,x,y)
     self.标题背景:置区域(self.特效计次,0,全局游戏宽度,全局游戏高度)
     self.标题背景:显示(0,-200)
	self.场景计次 = self.场景计次 - 0.3
	self.场景覆盖:置区域(self.场景计次,0,全局游戏宽度,全局游戏高度)
   self.场景覆盖:显示(0,550)
	for n=1,4 do
		self.动画[n]:更新(dt)
	    self.动画[n]:显示(全局游戏宽度-600 + (n-1) *110,全局游戏高度-100)
	end
	if self.特效覆盖 ~= nil then
		self.特效计次 = self.特效计次 - 0.7
		self.特效覆盖:置区域(self.特效计次,0,全局游戏宽度,全局游戏高度)
		self.特效覆盖:显示(0,全局游戏高度)
	end
	--self.梦幻LOGO:显示(全局游戏宽度/2-210,全局游戏高度/2-280)

	self.梦幻LOGO:显示(全局游戏宽度/2-120,全局游戏高度/2-10-280)

	if tp.进程 == 1 then
        local msg宽度 =全局游戏宽度/2-250--200
        local msg高度 =全局游戏高度/2-200--200
		self.丰富文本说明:更新(dt,x,y)
		--self.标题背景公告:更新(dt,x,y)
		self.进入游戏:更新(x,y)
		self.退出游戏:更新(x,y)
		self.免注册体验:更新(x,y)
		self.注册账号:更新(x,y)
		self.制作团队:更新(x,y)
		-- self.游戏公告:更新(x,y)
		-- self.游戏建议:更新(x,y)
		-- self.服务条款:更新(x,y)
		self.资源组[5]:更新(x,y,self.介绍加入 > 0)
		self.资源组[6]:更新(x,y,self.介绍加入 < #self.丰富文本说明.显示表 - 20)

		--self.游戏公告:更新(x,y)
		if self.资源组[5]:事件判断() then
				self.丰富文本说明:滚动(1)
				self.介绍加入=self.介绍加入-1
			self.资源组[10]:置起始点(self.资源组[10]:取百分比转换(self.介绍加入-1,20,#self.丰富文本说明.显示表))
		elseif self.资源组[6]:事件判断() then
				self.丰富文本说明:滚动(-1)
				self.介绍加入=self.介绍加入+1
			self.资源组[10]:置起始点(self.资源组[10]:取百分比转换(self.介绍加入+1,20,#self.丰富文本说明.显示表))
		end
		if(self.标题背景公告:是否选中(x,y) ) and 引擎.取鼠标滚轮() >0 then--鼠标上滚动
			if self.丰富文本说明.滚动值 < #self.丰富文本说明.显示表 -20 then
				self.丰富文本说明:滚动(1)
				self.介绍加入=self.介绍加入-1
			end
		elseif (self.标题背景公告:是否选中(x,y)) and 引擎.取鼠标滚轮() <0  then--鼠标下滚动
			if self.丰富文本说明.滚动值 > 0 then
				self.丰富文本说明:滚动(-1)
				self.介绍加入=self.介绍加入+1
			end
		end
		tp.鼠标.还原鼠标()
		if self.进入游戏:事件判断() then
			tp.进程 = 8
	   elseif self.免注册体验:事件判断() then
			tp.常规提示:打开("    游戏官方: WWW.163.COM ")
	elseif self.注册账号:事件判断() then
        -- tp.进程 = 5
        tp.进程 = 8
	    elseif self.制作团队:事件判断() then
			tp.常规提示:打开(tostring(全局msg制作团队))
		elseif self.退出游戏:事件判断() then
			引擎关闭开始()
			return false
		end


	    -- 标签图片区域（用图片+手动判断点击）
    -- 标签图片区域（用图片+手动判断点击）
    local 按钮y = 全局游戏高度-455
    local 公告x, 建议x, 条款x = 全局游戏宽度-720, 全局游戏宽度-520, 全局游戏宽度-320
    local 按钮宽, 按钮高 = 120, 40
    -- 公告榜
    if x >= 公告x and x <= 公告x+按钮宽 and y >= 按钮y and y <= 按钮y+按钮高 and 引擎.鼠标弹起(0) then
      if self.当前标签 ~= "公告榜" then
        self:切换标签("公告榜")
      end
    end
    -- 游戏建议
    if x >= 建议x and x <= 建议x+按钮宽 and y >= 按钮y and y <= 按钮y+按钮高 and 引擎.鼠标弹起(0) then
      if self.当前标签 ~= "游戏建议" then
        self:切换标签("游戏建议")
      end
    end
    -- 服务条款
    if x >= 条款x and x <= 条款x+按钮宽 and y >= 按钮y and y <= 按钮y+按钮高 and 引擎.鼠标弹起(0) then
      if self.当前标签 ~= "服务条款" then
        self:切换标签("服务条款")
      end
    end
    -- 显示图片（高亮当前标签）
    if self.当前标签 == "公告榜" then
      self.游戏公告:显示(公告x,按钮y)
      tp.字体表.标题字体:置颜色(0xFFFFD700):显示(公告x+20,按钮y+10,"公告榜")
    else
      self.游戏公告:显示(公告x,按钮y)
      tp.字体表.标题字体:置颜色(0xFFFFFFFF):显示(公告x+20,按钮y+10,"公告榜")
    end
    if self.当前标签 == "游戏建议" then
      self.游戏建议:显示(建议x,按钮y)
      tp.字体表.标题字体:置颜色(0xFFFFD700):显示(建议x+20,按钮y+10,"游戏建议")
    else
      self.游戏建议:显示(建议x,按钮y)
      tp.字体表.标题字体:置颜色(0xFFFFFFFF):显示(建议x+20,按钮y+10,"游戏建议")
    end
    if self.当前标签 == "服务条款" then
      self.服务条款:显示(条款x,按钮y)
      tp.字体表.标题字体:置颜色(0xFFFFD700):显示(条款x+20,按钮y+10,"服务条款")
    else
      self.服务条款:显示(条款x,按钮y)
      tp.字体表.标题字体:置颜色(0xFFFFFFFF):显示(条款x+20,按钮y+10,"服务条款")
    end
    -- 恢复内容区背景
    self.标题背景公告:显示(msg宽度-100, msg高度+30)
    -- 内容区域
    self.丰富文本说明:显示(msg宽度-75,msg高度+160)
		self.注册账号:显示(全局游戏宽度-150,全局游戏高度-250)
		self.制作团队:显示(全局游戏宽度-150,全局游戏高度-200)--320
		self.退出游戏:显示(全局游戏宽度-150,全局游戏高度-150)--240
		self.进入游戏:显示(全局游戏宽度-150,全局游戏高度-100)
		self.游戏公告:显示(全局游戏宽度-720,全局游戏高度-455)
		self.游戏建议:显示(全局游戏宽度-520,全局游戏高度-455)
		self.服务条款:显示(全局游戏宽度-320,全局游戏高度-455)
        self.欢迎:显示(全局游戏宽度-740,全局游戏高度-380)
        self.滑道:显示(全局游戏宽度-200,全局游戏高度-375)
		self.资源组[5]:显示(msg宽度+ 451,msg高度+115)
		self.资源组[6]:显示(msg宽度+ 451,msg高度+415)
		self.温馨提示:显示(msg宽度- 95,msg高度+475)



	 end
end






return 场景类_标题